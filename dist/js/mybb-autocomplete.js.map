{"version":3,"sources":["mybb-autocomplete.js"],"names":["MyBBAutocomplete","customOptions","selector","options","bank","only","char","vals","lang","blank","more","none","unexp","error","isNumeric","number","isNaN","parseFloat","isFinite","build","domString","parseHTML","textContent","trim","tmp","document","implementation","createHTMLDocument","body","innerHTML","children","$","fn","fyl","opts","conf","extend","main","fyd","attr","fyls","fylr","after","clone","pop","find","err","outerWidth","width","nVal","each","val","split","i","append","replace","reX","on","e","stopPropagation","clk","event","target","id","addClass","slideDown","focus","className","name","text","remove","parent","keyup","inVal","sx","inLen","length","errStr","show","html","hide","ajax","url","type","data","cache","success","json","isJ","JSON","parse","ins","exist","item","inArray","erm","xhr","desc","complete","css","outerHeight","removeClass","slice","t","jQuery"],"mappings":"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","file":"mybb-autocomplete.js","sourcesContent":["/**\n * MyBB Autocomplete\n * \n * @author: effone <me@eff.one>\n * @author: Eric Jackson\n * @website: https://github.com/effone/jquery.fyl\n * @license: MIT\n */\n\nclass MyBBAutocomplete {\n    constructor (customOptions, selector) {\n        this.options = Object.assign({\n            bank: '',\n            only: false,\n            char: 3,\n            vals: '',\n            lang: {\n                blank: \"Min {x} chars.\",\n                more: \"{x} more chars.\",\n                none: \"No match.\",\n                unexp: \"Bad data.\",\n                error: \"Error!\"\n            }\n        }, customOptions);\n\n        if (!isNumeric(this.options.char) || this.options.char < 1) {\n            this.options.char = 1;\n        }\n\n        const isNumeric = (number) => !isNaN(parseFloat(number)) && isFinite(number);\n        const build = (domString) => parseHTML(domString).textContent.trim;\n\n        const parseHTML = function(domString) {\n            let tmp = document.implementation.createHTMLDocument();\n            tmp.body.innerHTML = domString;\n            return tmp.body.children;\n        };\n    }\n}\n\n; (function ($) {\n    $.fn.fyl = function (opts) {\n        var conf = $.extend({\n            bank: '',\n            only: false,\n            char: 3,\n            vals: '',\n            lang: {\n                blank: \"Min {x} chars.\",\n                more: \"{x} more chars.\",\n                none: \"No match.\",\n                unexp: \"Bad data.\",\n                error: \"Error!\"\n            }\n        }, opts);\n\n        if (!$.isNumeric(conf.char) || conf.char < 1) { conf.char = 1; }\n        var main = $(this);\n        var fyd = 'fyl-' + main.attr('id');\n        var fyls = '<span class=\\'fyls\\'>{i}<span class=\\'fylx\\'>&#10006;</span></span>';\n        var fylr = '<div class=\\'fylr\\'>{r}</div>'\n\n\n        main.after('<div id=\\'' + fyd + '\\'><div class=\\'pop\\'><input type=\\'text\\' class=\\'srch\\' placeholder=\\'Search\\' autocomplete=\\'off\\'><span class=\\'spin\\'></span><div class=\\'err\\'></div><div class=\\'rslt\\'></div></div></div>');//.hide();\n        var clone = $('#' + fyd);\n        var pop = clone.find('.pop');\n        var err = pop.find('.err');\n        clone.outerWidth(main.outerWidth());\n        pop.width(clone.width());\n        // Add the predefined values\n        var nVal = 0;\n        $.each($.trim(!$.trim(conf.vals) ? main.val() : conf.vals).split(','), function (i, val) {\n            if (!conf.only) { nVal = 0; }\n            if ($.trim(val) && nVal < 1) {\n                clone.append(fyls.replace('{i}', $.trim(val)));\n                nVal++;\n            }\n        });\n        reX();\n\n\n        $(document).on('click', function () { reX(); });\n\n        clone.on('click', function (e) {\n            e.stopPropagation();\n            var clk = event.target;\n            if (clk.id == fyd) {\n                $(this).addClass('open').find('.pop').slideDown('fast').find('.srch').focus();\n            } else if (clk.className == 'fylr') {\n                var name = $(clk).text();\n                if (conf.only) {\n                    $(this).find('.fyls').remove();\n                }\n                $(this).append(fyls.replace('{i}', name));\n                reX();\n            } else if (clk.className == 'fylx') {\n                $(clk).parent().remove();\n                reX();\n            }\n        });\n\n        pop.find('.srch').keyup(function () {\n            pop.find('.fylr').remove();\n            var inVal = sx($(this).val());\n            var inLen = inVal.length;\n            if (inLen < conf.char) {\n                var errStr = inLen > 0 ? 'more' : 'blank';\n                err.show().html(conf.lang[errStr].replace('{x}', conf.char - inLen));\n            } else {\n                err.hide();\n                pop.find('.spin').show();\n                $.ajax({\n                    url: conf.bank,\n                    type: 'post',\n                    data: { 'search': inVal },\n                    cache: false,\n                    success: function (json) {\n                        var isJ = true;\n                        try { JSON.parse(json); } catch (e) { isJ = false; }\n                        pop.find('.fylr').remove();\n                        var ins = 0;\n                        if (isJ) {\n                            var exist = $(main).val().split(',');\n                            $.each(JSON.parse(json), function (i, item) {\n                                if ($.inArray(sx(item), exist) === -1) {\n                                    pop.find('.rslt').append(fylr.replace('{r}', $.trim(item)));\n                                    ins++;\n                                }\n                            });\n                        }\n                        if (ins == 0) {\n                            var erm = isJ ? 'none' : 'unexp';\n                            err.html(conf.lang[erm]).show();\n                        }\n                    },\n                    error: function (xhr, desc, err) {\n                        // console.log(xhr.status + \" - \" + desc + \" - \" + err);\n                        pop.find('.fylr').remove();\n                        err.html(conf.lang.error).show();\n                    },\n                    complete: function () {\n                        pop.find('.spin').hide();\n                    }\n                });\n            }\n        });\n\n        function reX() {\n            pop.find('.fylr').remove();\n            pop.find('.spin').hide();\n            pop.css('margin-top', clone.outerHeight() - 2 + 'px').hide().find('.srch').val('');\n            clone.removeClass('open').find('.err').show().html(conf.lang.blank.replace('{x}', conf.char));\n            main.val(clone.find('.fyls').text().replace(/✖/g, ',').slice(0, -1));\n        }\n\n        function sx(t) { return $.trim($($.parseHTML(t)).text()); }\n    };\n}(jQuery));"]}