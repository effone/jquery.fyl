"use strict";function _extends(){return(_extends=Object.assign||function(a){for(var r=1;r<arguments.length;r++){var n=arguments[r];for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(a[e]=n[e])}return a}).apply(this,arguments)}function _classCallCheck(a,r){if(!(a instanceof r))throw new TypeError("Cannot call a class as a function")}var MyBBAutocomplete=function a(r,n){_classCallCheck(this,a),this.options=_extends({bank:"",only:!1,char:3,vals:"",lang:{blank:"Min {x} chars.",more:"{x} more chars.",none:"No match.",unexp:"Bad data.",error:"Error!"}},r),(!e(this.options.char)||this.options.char<1)&&(this.options.char=1);var e=function(a){return!isNaN(parseFloat(a))&&isFinite(a)}};!function(p){p.fn.fyl=function(a){var t=p.extend({bank:"",only:!1,char:3,vals:"",lang:{blank:"Min {x} chars.",more:"{x} more chars.",none:"No match.",unexp:"Bad data.",error:"Error!"}},a);(!p.isNumeric(t.char)||t.char<1)&&(t.char=1);var s=p(this),e="fyl-"+s.attr("id"),i="<span class='fyls'>{i}<span class='fylx'>&#10006;</span></span>";s.after("<div id='"+e+"'><div class='pop'><input type='text' class='srch' placeholder='Search' autocomplete='off'><span class='spin'></span><div class='err'></div><div class='rslt'></div></div></div>");var n=p("#"+e),o=n.find(".pop"),l=o.find(".err");n.outerWidth(s.outerWidth()),o.width(n.width());var c=0;function f(){o.find(".fylr").remove(),o.find(".spin").hide(),o.css("margin-top",n.outerHeight()-2+"px").hide().find(".srch").val(""),n.removeClass("open").find(".err").show().html(t.lang.blank.replace("{x}",t.char)),s.val(n.find(".fyls").text().replace(/âœ–/g,",").slice(0,-1))}function h(a){return p.trim(p(p.parseHTML(a)).text())}p.each(p.trim(p.trim(t.vals)?t.vals:s.val()).split(","),function(a,r){t.only||(c=0),p.trim(r)&&c<1&&(n.append(i.replace("{i}",p.trim(r))),c++)}),f(),p(document).on("click",function(){f()}),n.on("click",function(a){a.stopPropagation();var r=event.target;if(r.id==e)p(this).addClass("open").find(".pop").slideDown("fast").find(".srch").focus();else if("fylr"==r.className){var n=p(r).text();t.only&&p(this).find(".fyls").remove(),p(this).append(i.replace("{i}",n)),f()}else"fylx"==r.className&&(p(r).parent().remove(),f())}),o.find(".srch").keyup(function(){o.find(".fylr").remove();var a=h(p(this).val()),r=a.length;if(r<t.char){var n=0<r?"more":"blank";l.show().html(t.lang[n].replace("{x}",t.char-r))}else l.hide(),o.find(".spin").show(),p.ajax({url:t.bank,type:"post",data:{search:a},cache:!1,success:function(a){var r=!0;try{JSON.parse(a)}catch(a){r=!1}o.find(".fylr").remove();var n=0;if(r){var e=p(s).val().split(",");p.each(JSON.parse(a),function(a,r){-1===p.inArray(h(r),e)&&(o.find(".rslt").append("<div class='fylr'>{r}</div>".replace("{r}",p.trim(r))),n++)})}if(0==n){var i=r?"none":"unexp";l.html(t.lang[i]).show()}},error:function(a,r,n){o.find(".fylr").remove(),n.html(t.lang.error).show()},complete:function(){o.find(".spin").hide()}})})}}(jQuery);